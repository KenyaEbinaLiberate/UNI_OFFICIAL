const a=new(window.AudioContext||window.webkitAudioContext),r=new Audio("/sound.mp3");r.loop=!0;const p=a.createMediaElementSource(r),o=a.createAnalyser();o.fftSize=512;const f=o.frequencyBinCount,w=new Uint8Array(f);p.connect(o);o.connect(a.destination);const t=document.getElementById("audioVisualizer"),e=t.getContext("2d"),y=()=>{t.width=120,t.height=window.innerHeight*1.5,t.style.height="150dvh"};y();window.addEventListener("resize",y);let g=!1,m;const C=()=>{o.getByteFrequencyData(w),e.clearRect(0,0,t.width,t.height);const d=t.width,l=f,i=t.height/l;for(let s=0;s<l;s++){const h=w[s]/255,u=Math.max(2,h*d);if(h>0){const n=i*s+i/2;e.beginPath(),e.moveTo(0,n-i/2.5),e.lineTo(0,n+i/2.5),e.lineTo(u,n),e.closePath();const c=e.createLinearGradient(0,n,u,n);c.addColorStop(0,"rgba(0, 0, 255, 1)"),c.addColorStop(1,"rgba(0, 0, 255, 1)"),e.shadowColor="rgba(0, 0, 255, 0)",e.shadowBlur=5,e.shadowOffsetX=-2,e.fillStyle=c,e.fill(),e.shadowColor="transparent",e.shadowBlur=0,e.shadowOffsetX=0}}m=requestAnimationFrame(C)};window.addEventListener("audioplayerstatechange",d=>{g=d.detail.isPlaying,g?(a.state==="suspended"&&a.resume(),r.play(),C()):(r.pause(),cancelAnimationFrame(m),e.clearRect(0,0,t.width,t.height))});
