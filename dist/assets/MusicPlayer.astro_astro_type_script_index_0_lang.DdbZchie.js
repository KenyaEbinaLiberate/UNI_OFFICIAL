const d=new(window.AudioContext||window.webkitAudioContext),p=new Audio("/sound.mp3");p.loop=!0;const E=d.createMediaElementSource(p),o=d.createAnalyser();o.fftSize=256;const l=o.frequencyBinCount,u=new Uint8Array(l);E.connect(o);o.connect(d.destination);const e=document.getElementById("visualizer"),n=e.getContext("2d"),g=()=>{e.width=150,e.height=150,e.style.width="150px",e.style.height="150px"};g();window.addEventListener("resize",g);let s=!1;const r=document.getElementById("musicPlayer"),h=r.querySelector(".play-icon"),w=r.querySelector(".pause-icon"),m=()=>{o.getByteFrequencyData(u),n.clearRect(0,0,e.width,e.height);const t=e.width/2,i=35;for(let a=0;a<l;a++){const y=u[a]*.5,c=a*2*Math.PI/l,z=t+i*Math.cos(c),f=t+i*Math.sin(c),v=t+(i+y)*Math.cos(c),C=t+(i+y)*Math.sin(c);n.beginPath(),n.moveTo(z,f),n.lineTo(v,C),n.strokeStyle=`rgba(255, 255, 255, ${s?.8:.3})`,n.lineWidth=2,n.stroke()}requestAnimationFrame(m)},b=()=>{s?(h.style.display="none",w.style.display="block"):(h.style.display="block",w.style.display="none")},x=t=>{window.dispatchEvent(new CustomEvent("audioplayerstatechange",{detail:{isPlaying:t}}))};r.addEventListener("click",()=>{s=!s,b(),x(s)});m();
