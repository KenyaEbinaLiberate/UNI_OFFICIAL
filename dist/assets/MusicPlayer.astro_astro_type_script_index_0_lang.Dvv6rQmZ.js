let e,t,n,o,a,i=[],s=0;let l,c=!1;const r=document.getElementById("musicPlayer"),d=r?.querySelector(".play-icon"),h=r?.querySelector(".pause-icon"),u=document.getElementById("visualizer"),y=u.getContext("2d"),m=()=>{const e=150;u.width=e,u.height=e,u.style.width="150px",u.style.height="150px"};m(),window.addEventListener("resize",m);const p=()=>{if(!n||!o)return;n.getByteFrequencyData(o),y.clearRect(0,0,u.width,u.height);const e=u.width/2,t=(e,t)=>{let n=0;for(let i=e;i<t&&i<a;i++)n+=o[i];return n/(t-e)},i=t(0,4),s=t(4,12),r=t(12,a),d=[];for(let n=0;n<a;n++){const e=o[n],t=n<a-1?o[n+1]:o[n];d.push(e);const i=(t-e)/8;for(let n=1;n<8;n++)d.push(e+i*n)}const h=d.length;for(let n=0;n<h;n++){let t=1;n<32?t=2:n<96&&(t=1.5);let o=r;n<32?o=i:n<96&&(o=s);const a=d[n]/255,l=(a*t*50+.2*o)*(c?1:.3),u=2*n*Math.PI/h,m=e+35*Math.cos(u),p=e+35*Math.sin(u),g=e+(35+l)*Math.cos(u),w=e+(35+l)*Math.sin(u);y.beginPath(),y.moveTo(m,p),y.lineTo(g,w);const E=n/h*360;y.strokeStyle=c?`hsla(${E}, 80%, 60%, ${.8*a+.2})`:"rgba(255, 255, 255, 0.3)",y.lineWidth=1.5,y.stroke()}l=requestAnimationFrame(p)};r?.addEventListener("click",(()=>{var r;e||(e=new AudioContext,i=[new Audio("/sound01.mp3")],i.forEach((e=>{e.loop=!0})),t=e.createMediaElementSource(i[s]),n=e.createAnalyser(),n.fftSize=512,n.smoothingTimeConstant=.6,a=n.frequencyBinCount,o=new Uint8Array(a),t.connect(n),n.connect(e.destination),i.forEach(((o,a)=>{o.addEventListener("ended",(()=>{c&&(s=(a+1)%i.length,t.disconnect(),t=e.createMediaElementSource(i[s]),t.connect(n),i[s].play())}))}))),"suspended"===e.state&&e.resume(),c=!c,c?(i[s].play(),p()):(i[s].pause(),l&&cancelAnimationFrame(l)),c?(d.style.display="none",h.style.display="block"):(d.style.display="block",h.style.display="none"),r=c,window.dispatchEvent(new CustomEvent("audioplayerstatechange",{detail:{isPlaying:r,audioElement:i[s],audioContext:e,analyser:n}}))}));
